<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
</head>

<body>
    <script src="ha.js"></script>
    <script>
        // 获取数据
        (() => {
            let query = new URLSearchParams(location.search)
            let link = query.get('link')
            let mode = parseInt(query.get('mode'))
            // 打开内置页面
            if (mode == 4) {
                top.history.replaceState(null, null, link)
                // top.document.querySelector('home-assistant')._route = {
                //     prefix: '',
                //     path: link,
                //     __queryParams: {}
                // }
                // top.document.querySelector('home-assistant')._panelUrl = link
                ha.fire('location-changed', { replace: true }, top)
                return
            }
            // 全屏模式
            if (mode == 2) {
                ha.fullscreen()
            } else {
                ha.fullscreen(1)
            }
            // 生成链接
            let a = document.createElement('a')
            a.target = '_blank'
            a.href = link
            a.textContent = link
            document.body.appendChild(a)

            if (mode == 3) {
                window.open(link)
            } else {
                location.href = link;
            }

        })()


    </script>
</body>

</html>